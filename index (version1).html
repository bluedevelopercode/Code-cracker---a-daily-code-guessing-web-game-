<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Code Cracker</title>
<style>
:root{
  --bg:#0b0b0d; --panel:#121216; --accent:#5383ff; --text:#e6eef8;
    --tile-bg:#111216; --tile-border:#22242b; --green:#6aaa64; --yellow:#c9b458; --grey:#787c7e;
    }
    *{box-sizing:border-box;}
    body{
      margin:0; font-family:Arial, sans-serif;
        background: linear-gradient(180deg,#050507 0%, #0b0b0d 100%);
          color:var(--text); min-height:100vh; display:flex; align-items:flex-start; justify-content:center;
            padding:28px 12px; overflow-x:hidden;
              -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
                }
                .app{ width:100%; max-width:640px; margin:0 auto;}
                header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:18px;}
                .title{ display:flex; align-items:end; gap:10px;}
                .logo{ width:64px; height:64px; background:var(--panel); border-radius:8px; display:flex; align-items:center; justify-content:center;
                  box-shadow: 0 6px 18px rgba(0,0,0,0.5); font-weight:700; font-size:18px; color:var(--accent);}
                  h1{font-size:22px; margin:0}
                  .controls{display:flex; gap:10px}
                  button.btn{ background:transparent; border:1px solid #2b2d33; color:var(--text); padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600; transition:0.2s;}
                  button.btn:hover{background:#22242b;}
                  button.btn.primary{background:var(--accent); color:#022; border:none;}
                  main.card{ background:var(--panel); border-radius:12px; padding:18px; box-shadow: 0 10px 30px rgba(0,0,0,0.6);}
                  .grid{display:grid; grid-template-rows: repeat(6, 1fr); gap:10px; margin:16px 0; height:430px;}
                  .row{display:flex; gap:10px; justify-content:center}
                  .tile{ width:62px; height:62px; border-radius:8px; background:var(--tile-bg); border:2px solid var(--tile-border);
                    display:flex; align-items:center; justify-content:center; font-size:28px; font-weight:700; color:var(--text); user-select:none; transition:0.3s transform,0.3s background;}
                    .tile.flip{transform:rotateX(180deg);}
                    .tile.correct{background:var(--green); color:#fff; border-color:var(--green);}
                    .tile.present{background:var(--yellow); color:#fff; border-color:var(--yellow);}
                    .tile.absent{background:var(--grey); color:#fff; border-color:var(--grey);}
                    .keypad{display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:10px}
                    .key{width:52px; height:44px; border-radius:8px; border:1px solid #2a2c32; background:#15161a; display:flex;align-items:center;justify-content:center;cursor:pointer;font-weight:700; transition:0.2s; user-select:none; -webkit-user-select:none; -ms-user-select:none;}
                    .key:hover{background:#22242b;}
                    .key.wide{width:110px; display:flex; align-items:center; justify-content:center; font-size:20px;}
                    .modal{ position:fixed; left:0; right:0; top:0; bottom:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.85); z-index:50; opacity:0; visibility:hidden; transition:0.3s;}
                    .modal.show{opacity:1; visibility:visible;}
                    .modal-panel{background:var(--panel); padding:18px; border-radius:12px; width:320px; color:var(--text); text-align:center; animation:fadeIn 0.4s;}
                    @keyframes fadeIn{from{opacity:0; transform:scale(0.9);} to{opacity:1; transform:scale(1);}}
                    .progress-bar{height:12px; background:#1b1d22; border-radius:8px; overflow:hidden; margin-top:6px}
                    .progress-bar > b{display:block; height:100%; background:linear-gradient(90deg,var(--accent),#7bb7ff); width:40%}
                    .small-muted{font-size:12px; color:#9aa6bf}
                    footer{margin-top:12px; display:flex; justify-content:space-between; align-items:center; font-size:13px;color:#9aa6bf}
                    .hint{font-size:13px; color:#9aa6bf; margin-top:6px}
                    .center{display:flex; align-items:center; justify-content:center}
                    .countdown{margin-top:8px; font-size:14px; color:#9aa6bf}
                    @media (max-width:420px){
                      .tile{width:48px;height:48px;font-size:22px}
                        .grid{height:360px}
                        }
                        </style>
                        </head>
                        <body>
                        <div class="app">
                        <header>
                          <div class="title">
                              <div class="logo">CC</div>
                                  <div>
                                        <h1>Code Cracker</h1>
                                              <div class="small-muted">Daily 4-digit code • 6 guesses • UTC based</div>
                                                  </div>
                                                    </div>
                                                      <div class="controls">
                                                          <button class="btn" id="helpBtn">How to</button>
                                                              <button class="btn" id="progressBtn">Progress</button>
                                                                </div>
                                                                </header>
                                                                <main class="card">
                                                                  <div class="hint center">Guess the 4-digit code of the day. Digits 0–9. Press Enter to submit.</div>
                                                                    <div id="grid" class="grid" aria-live="polite"></div>
                                                                      <div class="center">
                                                                          <div id="status" class="small-muted"></div>
                                                                            </div>
                                                                              <div class="keypad" id="keypad"></div>
                                                                                <footer>
                                                                                    <div class="small-muted">made by @developeryatharth</div>
                                                                                      </footer>
                                                                                      </main>

                                                                                      <!-- How to Modal -->
                                                                                      <div class="modal" id="helpModal">
                                                                                        <div class="modal-panel">
                                                                                            <h3>How to Play</h3>
                                                                                                <p>Guess the 4-digit code of the day in 6 attempts.</p>
                                                                                                    <ul style="text-align:left;">
                                                                                                          <li>Green: Correct digit & correct position</li>
                                                                                                                <li>Yellow: Digit exists but wrong position (only one per repeated code digit)</li>
                                                                                                                      <li>Grey: Digit not in code</li>
                                                                                                                          </ul>
                                                                                                                              <button class="btn primary" onclick="closeHelp()">Close</button>
                                                                                                                                </div>
                                                                                                                                </div>

                                                                                                                                <!-- Progress Modal -->
                                                                                                                                <div class="modal" id="progressModal">
                                                                                                                                  <div class="modal-panel">
                                                                                                                                      <h3>Progress</h3>
                                                                                                                                          <p>Current streak: <span id="streakDisplay">0</span></p>
                                                                                                                                              <p>Total matches played: <span id="matchesDisplay">0</span></p>
                                                                                                                                                  <p>Win percentage: <span id="winPct">0%</span></p>
                                                                                                                                                      <p>Average guesses for wins: <span id="avgGuesses">0</span></p>
                                                                                                                                                          <div class="progress-bar"><b id="progressBar"></b></div>
                                                                                                                                                              <button class="btn primary" onclick="closeProgress()">Close</button>
                                                                                                                                                                </div>
                                                                                                                                                                </div>

                                                                                                                                                                <!-- Win/Loss Modal -->
                                                                                                                                                                <div class="modal" id="endModal">
                                                                                                                                                                  <div class="modal-panel center">
                                                                                                                                                                      <h2 id="endMessage"></h2>
                                                                                                                                                                          <p id="endInfo"></p>
                                                                                                                                                                              <p id="countdownEnd" class="countdown"></p>
                                                                                                                                                                                  <button class="btn primary" onclick="closeEndModal()">OK</button>
                                                                                                                                                                                    </div>
                                                                                                                                                                                    </div>

                                                                                                                                                                                    <script>
                                                                                                                                                                                    // --- Chrome check ---
                                                                                                                                                                                    if(!navigator.userAgent.includes("Chrome")){
                                                                                                                                                                                      document.body.innerHTML = `<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;color:#fff;background:#000;font-family:sans-serif;"><h1>Please open this game in Google Chrome</h1><p>This game is optimized for Chrome browser only.</p></div>`;
                                                                                                                                                                                        throw new Error("Not Chrome");
                                                                                                                                                                                        }

                                                                                                                                                                                        // --- DAILY CODE ---
                                                                                                                                                                                        const todayUTC = new Date();
                                                                                                                                                                                        const todayKey = todayUTC.getUTCFullYear()+"-"+(todayUTC.getUTCMonth()+1)+"-"+todayUTC.getUTCDate();
                                                                                                                                                                                        let lastPlayed = localStorage.getItem('lastPlayed')||'';
                                                                                                                                                                                        let streak = parseInt(localStorage.getItem('streak')||'0',10);
                                                                                                                                                                                        let matchesPlayed = parseInt(localStorage.getItem('matches')||'0',10);
                                                                                                                                                                                        let wins = parseInt(localStorage.getItem('wins')||'0',10);
                                                                                                                                                                                        let totalGuessesForWins = parseInt(localStorage.getItem('totalGuessesForWins')||'0',10);
                                                                                                                                                                                        let gameOver = false;
                                                                                                                                                                                        if(lastPlayed === todayKey){gameOver = true;}

                                                                                                                                                                                        function generateCode(){
                                                                                                                                                                                          const today = new Date();
                                                                                                                                                                                            const seed = today.getUTCFullYear()*10000 + (today.getUTCMonth()+1)*100 + today.getUTCDate();
                                                                                                                                                                                              const random = (seed*9301+49297)%233280/233280;
                                                                                                                                                                                                return String(Math.floor(random*10000)).padStart(4,'0');
                                                                                                                                                                                                }
                                                                                                                                                                                                let code = generateCode();
                                                                                                                                                                                                const maxGuesses = 6;
                                                                                                                                                                                                let currentRow = 0;
                                                                                                                                                                                                let currentGuess = [];

                                                                                                                                                                                                // --- GRID ---
                                                                                                                                                                                                const grid = document.getElementById('grid');
                                                                                                                                                                                                function initGrid(){
                                                                                                                                                                                                  grid.innerHTML='';
                                                                                                                                                                                                    for(let i=0;i<maxGuesses;i++){
                                                                                                                                                                                                        const row = document.createElement('div'); row.className='row';
                                                                                                                                                                                                            for(let j=0;j<4;j++){
                                                                                                                                                                                                                  const tile = document.createElement('div'); tile.className='tile';
                                                                                                                                                                                                                        row.appendChild(tile);
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                grid.appendChild(row);
                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                  initGrid();

                                                                                                                                                                                                                                  // --- KEYPAD ---
                                                                                                                                                                                                                                  const keypad = document.getElementById('keypad');
                                                                                                                                                                                                                                  for(let i=0;i<=9;i++){
                                                                                                                                                                                                                                    const key = document.createElement('div'); 
                                                                                                                                                                                                                                      key.className='key'; 
                                                                                                                                                                                                                                        key.textContent=i;
                                                                                                                                                                                                                                          key.addEventListener('click', ()=>{ 
                                                                                                                                                                                                                                              if(!gameOver && currentGuess.length<4){ 
                                                                                                                                                                                                                                                    currentGuess.push(i.toString()); 
                                                                                                                                                                                                                                                          renderGuess();
                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                  keypad.appendChild(key);
                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                  const enterKey = document.createElement('div'); 
                                                                                                                                                                                                                                                                  enterKey.textContent='Enter'; enterKey.className='key wide';
                                                                                                                                                                                                                                                                  enterKey.addEventListener('click', submitGuess); keypad.appendChild(enterKey);
                                                                                                                                                                                                                                                                  const delKey = document.createElement('div'); 
                                                                                                                                                                                                                                                                  delKey.className='key wide'; delKey.innerHTML='⌫';
                                                                                                                                                                                                                                                                  delKey.addEventListener('click', ()=>{
                                                                                                                                                                                                                                                                    if(!gameOver){ currentGuess.pop(); renderGuess(); }
                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                    keypad.appendChild(delKey);

                                                                                                                                                                                                                                                                    // --- KEYBOARD ---
                                                                                                                                                                                                                                                                    document.addEventListener('keydown', e=>{
                                                                                                                                                                                                                                                                      if(gameOver) return;
                                                                                                                                                                                                                                                                        if(e.key>='0' && e.key<='9'){ if(currentGuess.length<4){ currentGuess.push(e.key); renderGuess(); } }
                                                                                                                                                                                                                                                                          else if(e.key==='Backspace'){ currentGuess.pop(); renderGuess(); }
                                                                                                                                                                                                                                                                            else if(e.key==='Enter'){ submitGuess(); }
                                                                                                                                                                                                                                                                            });

                                                                                                                                                                                                                                                                            // --- RENDER GUESS ---
                                                                                                                                                                                                                                                                            function renderGuess(){
                                                                                                                                                                                                                                                                              const row = grid.children[currentRow];
                                                                                                                                                                                                                                                                                for(let i=0;i<4;i++){
                                                                                                                                                                                                                                                                                    const tile = row.children[i];
                                                                                                                                                                                                                                                                                        // Use requestAnimationFrame to ensure digits render on touch
                                                                                                                                                                                                                                                                                            requestAnimationFrame(()=>{ tile.textContent=currentGuess[i]||''; });
                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                              }

                                                                                                                                                                                                                                                                                              // --- SUBMIT GUESS ---
                                                                                                                                                                                                                                                                                              const endModal = document.getElementById('endModal');
                                                                                                                                                                                                                                                                                              const endMessage = document.getElementById('endMessage');
                                                                                                                                                                                                                                                                                              const endInfo = document.getElementById('endInfo');
                                                                                                                                                                                                                                                                                              const countdownEnd = document.getElementById('countdownEnd');

                                                                                                                                                                                                                                                                                              function submitGuess(){
                                                                                                                                                                                                                                                                                                if(currentGuess.length<4 || gameOver) return;
                                                                                                                                                                                                                                                                                                  let codeCount={}; for(let ch of code) codeCount[ch]=(codeCount[ch]||0)+1;
                                                                                                                                                                                                                                                                                                    const row = grid.children[currentRow];
                                                                                                                                                                                                                                                                                                      for(let i=0;i<4;i++){
                                                                                                                                                                                                                                                                                                          const tile=row.children[i]; const g=currentGuess[i];
                                                                                                                                                                                                                                                                                                              if(g===code[i]){ tile.className='tile correct'; codeCount[g]--; }
                                                                                                                                                                                                                                                                                                                  else if(code.includes(g) && codeCount[g]>0){ tile.className='tile present'; codeCount[g]--; }
                                                                                                                                                                                                                                                                                                                      else{ tile.className='tile absent'; }
                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                          if(currentGuess.join('')===code){
                                                                                                                                                                                                                                                                                                                              streak++; wins++; totalGuessesForWins+=currentRow+1; matchesPlayed++;
                                                                                                                                                                                                                                                                                                                                  localStorage.setItem('streak',streak); localStorage.setItem('matches',matchesPlayed);
                                                                                                                                                                                                                                                                                                                                      localStorage.setItem('wins',wins); localStorage.setItem('totalGuessesForWins',totalGuessesForWins);
                                                                                                                                                                                                                                                                                                                                          localStorage.setItem('lastPlayed',todayKey);
                                                                                                                                                                                                                                                                                                                                              showEndModal(true); return;
                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                  currentRow++; currentGuess=[];
                                                                                                                                                                                                                                                                                                                                                    if(currentRow>=maxGuesses){
                                                                                                                                                                                                                                                                                                                                                        streak=0; matchesPlayed++;
                                                                                                                                                                                                                                                                                                                                                            localStorage.setItem('streak',streak); localStorage.setItem('matches',matchesPlayed); localStorage.setItem('lastPlayed',todayKey);
                                                                                                                                                                                                                                                                                                                                                                showEndModal(false); gameOver=true;
                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                  }

                                                                                                                                                                                                                                                                                                                                                                  // --- END MODAL ---
                                                                                                                                                                                                                                                                                                                                                                  function showEndModal(win){
                                                                                                                                                                                                                                                                                                                                                                    gameOver=true;
                                                                                                                                                                                                                                                                                                                                                                      if(win){ endMessage.textContent="Impressive!"; endMessage.style.color="var(--green)";
                                                                                                                                                                                                                                                                                                                                                                          endInfo.textContent=`You cracked the code in ${currentRow+1} guess${currentRow+1>1?'es':''}!`;
                                                                                                                                                                                                                                                                                                                                                                            } else { endMessage.textContent="Game Over!"; endMessage.style.color="var(--yellow)";
                                                                                                                                                                                                                                                                                                                                                                                endInfo.textContent=`The code was ${code}`;
                                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                                    updateCountdownEnd();
                                                                                                                                                                                                                                                                                                                                                                                      endModal.classList.add('show');
                                                                                                                                                                                                                                                                                                                                                                                      }
                                                                                                                                                                                                                                                                                                                                                                                      function updateCountdownEnd(){
                                                                                                                                                                                                                                                                                                                                                                                        const now=new Date(); const nextUTC=new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()+1,0,0,0));
                                                                                                                                                                                                                                                                                                                                                                                          const diff=nextUTC-now; const h=Math.floor(diff/1000/3600); const m=Math.floor(diff/1000%3600/60); const s=Math.floor(diff/1000%60);
                                                                                                                                                                                                                                                                                                                                                                                            countdownEnd.textContent=`Next code in ${h}h ${m}m ${s}s`;
                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                            function closeEndModal(){ endModal.classList.remove('show'); }

                                                                                                                                                                                                                                                                                                                                                                                            // --- MODALS ---
                                                                                                                                                                                                                                                                                                                                                                                            const helpModal=document.getElementById('helpModal');
                                                                                                                                                                                                                                                                                                                                                                                            const progressModal=document.getElementById('progressModal');
                                                                                                                                                                                                                                                                                                                                                                                            const streakDisplay=document.getElementById('streakDisplay');
                                                                                                                                                                                                                                                                                                                                                                                            const matchesDisplay=document.getElementById('matchesDisplay');
                                                                                                                                                                                                                                                                                                                                                                                            const winPctDisplay=document.getElementById('winPct');
                                                                                                                                                                                                                                                                                                                                                                                            const avgGuessesDisplay=document.getElementById('avgGuesses');
                                                                                                                                                                                                                                                                                                                                                                                            const progressBar=document.getElementById('progressBar');

                                                                                                                                                                                                                                                                                                                                                                                            document.getElementById('helpBtn').addEventListener('click',()=>{helpModal.classList.add('show');});
                                                                                                                                                                                                                                                                                                                                                                                            document.getElementById('progressBtn').addEventListener('click',()=>{
                                                                                                                                                                                                                                                                                                                                                                                              streakDisplay.textContent=streak; matchesDisplay.textContent=matchesPlayed;
                                                                                                                                                                                                                                                                                                                                                                                                const pct=matchesPlayed>0?Math.round((wins/matchesPlayed)*100):0; winPctDisplay.textContent=pct+'%';
                                                                                                                                                                                                                                                                                                                                                                                                  const avg=wins>0?Math.round(totalGuessesForWins/wins):0; avgGuessesDisplay.textContent=avg;
                                                                                                                                                                                                                                                                                                                                                                                                    progressBar.style.width=Math.min(streak*20,100)+'%'; progressModal.classList.add('show');
                                                                                                                                                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                                                                                                                                                    function closeHelp(){helpModal.classList.remove('show')}
                                                                                                                                                                                                                                                                                                                                                                                                    function closeProgress(){progressModal.classList.remove('show')}
                                                                                                                                                                                                                                                                                                                                                                                                    </script>
                                                                                                                                                                                                                                                                                                                                                                                                    </body>
                                                                                                                                                                                                                                                                                                                                                                                                    </html>
                                                                                                                                                                                                                                                                                                                                                                                                    
